## Malware Threats

### Trojans (RATs)
1. njRAT
    - Server listens for victim connection at a predefined port. Default port `5552`
    - Startup options: registry, startup folder
    - Provides: 
      - Remote desktop, file manager, process manager
      - manipulate network connections, running services, edit registry entries
      - remote shell, keylogger, extract passwords
      - remove cam/mic, chat
2. HTTP RAT
   - Browse victim machine at http://<victim ip>:<predefined port>
   - Victim IP received via email
3. Others: 
   - Theef RAT (Port 6703, FTP 2968)
   - MoSucker, ProRAT (Port 5110)

 
### Viruses
1. JPS Virus Maker
   - Provides:
     - Disable various windows applications: task manager, registry editor, control panel, etc.
     - Disable various windows services: windows firewall, windows update, etc.
     - Hide clock, icons, taskbar, etc.
     - Change user password, computer name, run commands etc.
   - Can be converted to worm or logic bomb.

### Static Malware Analysis
1. www.hybrid-analysis.com
   - Gives type, mime type, hashes, links to other analysis sites
2. www.virustotal.com
    - Tabs: Detection, Details, Relations, Behavior
3. String search
   1. BinText
      - Run from CEH Tools > select malicious file
      - Observe strings
      - ANSI strings: green “A,” 
      - Unicode strings (double byte ANSI): red “U” 
      - Resource strings: blue “R” with decimal resource ID
4. Packaging and obfuscation
   1. PEiD
      - Run from CEH Tools > select malicious file
      - Observe entry point, EP Section, offset, subsystem, tasks
   2. Analyse ELF executable using Detect It Easy (DIE)

      The Executable and Linkable Format (ELF) is a generic executable file format in Linux environment. It contains three main components including ELF header, sections, and segments.
      - Run from CEH Tools
      - File Info button
      - Details provided:
          - Hashes, entropy, entry point, base address
          - OS, compiler, language
5. PE Extraction

   The Portable Executable (PE) format is the executable file format used on Windows OSes that stores the information a Windows system requires to manage the executable code.
   1. PE Explorer
      - Install from CEH Tools > open malicious file
      - Observe PE header, data directories, sections, imports, exports, resources, etc.
6. Identify File Dependencies using Dependency Walker
   - Run from CEH Tools > open malicious file
   - List all the DLLs that an executable file is using.
7. Malware Disassembly
   1. IDA
      - Run from start menu > select malicious file
      - Functions/sub-routines sub window at left
      - IDA View-A tab > Right click > Text view
      - Copy qwingraph file to program files
      - View > Graphs > Flow chart
      - View > Graphs > Function calls
      - Other tabs: Hex View 1, Structures, Enums, Imports, Exports etc.
      - Close windows
   2. OllyDbg
      - Run from CEH Tools > close all sub windows > open malicious files
      - maximize CPU main thread
      - View > Log
        - Observe program entry point
      - View > Executable modules
        - Double click on module to view details
      - View > Threads
        - Observe threads
      - View > Memory
        - Observe memory map
   3. Ghidra
      - Run from CEH Tools > bat file > Import malicious file
      - Import summary has information about the file (compiler ID, language, etc.)

### Dynamic Malware Analysis
1. Port monitoring
   1. TCPView
      - Run from CEH Tools
      - Observe local ports, process name for it, remote address, remote port
   2. CurrPorts
      - Run from CEH Tools
      - Observe local ports, process name for it, remote address, remote port
      - Right click on properties to view more details
2. Process Monitoring
   1. Process Monitor
      - Run from CEH Tools
      - Observe processes running and events/operations performed like edit registry
      - Right click on process to view more details [Event, process, Stack(DLLs)]
3. Registry Monitoring
   - Reg Organizer (to scan the registry values for any changes)
     - Tools > registry Snapshots
4. Windows services monitoring
   - Windows Service Manager (SrvMan)
5. Startup program monitoring
   - Autoruns for Windows
   - WinPatrol
6. Installation monitoring
   - Mirekusoft Install Monitor
7. Files and folder monitoring
   - PA File Sight (can the system for suspicious files and folders)
8. Device driver monitoring
   - DriverView
   - Driver Reviver
9. DNS monitoring
   - DNSQuerySniffer (Detect if attacker has changed DNS settings)